# é‡æ„åçš„å®Œæ•´ç»“æ„å›¾
## Linusé£æ ¼æ¶æ„ - å¯è§†åŒ–è¯¦è§£

---

## ğŸ“ å®Œæ•´ç›®å½•ç»“æ„

```
xLP/                                    # é¡¹ç›®æ ¹ç›®å½•
â”‚
â”œâ”€â”€ main.py                             # 120 lines - å…¥å£ + æ’ä»¶ç»„è£…
â”‚
â”œâ”€â”€ src/
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                           # Layer 1: çº¯å‡½æ•°å±‚ (æ ¸å¿ƒä¸šåŠ¡é€»è¾‘)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ offset_tracker.py          # 92 lines  âœ… å·²å®Œç¾ (ä¿æŒä¸å˜)
â”‚   â”‚   â”œâ”€â”€ zone_calculator.py         # 30 lines  ğŸ†• Zoneè®¡ç®— (çº¯å‡½æ•°)
â”‚   â”‚   â”œâ”€â”€ decision_logic.py          # 100 lines ğŸ†• å†³ç­–è§„åˆ™ (çº¯å‡½æ•°)
â”‚   â”‚   â””â”€â”€ order_calculator.py        # 30 lines  ğŸ†• è®¢å•å‚æ•° (çº¯å‡½æ•°)
â”‚   â”‚
â”‚   â”œâ”€â”€ adapters/                       # Layer 2: I/Oé€‚é…å™¨å±‚
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ exchange_client.py         # 100 lines ğŸ†• äº¤æ˜“æ‰€å°è£… + è®¢å•ç¡®è®¤
â”‚   â”‚   â”œâ”€â”€ state_store.py             # 80 lines  ğŸ†• çŠ¶æ€å­˜å‚¨ (æ›¿ä»£StateManager)
â”‚   â”‚   â””â”€â”€ pool_fetcher.py            # 60 lines  ğŸ†• æ± å­æ•°æ®è·å–
â”‚   â”‚
â”‚   â”œâ”€â”€ hedge_bot.py                    # 200 lines ğŸ†• Layer 3: ä¸»ç¼–æ’é€»è¾‘
â”‚   â”‚
â”‚   â”œâ”€â”€ plugins/                        # å¯é€‰åŠŸèƒ½æ’ä»¶ (å›è°ƒæ³¨å…¥)
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ audit_log.py               # 60 lines  ğŸ†• å®¡è®¡æ—¥å¿—
â”‚   â”‚   â”œâ”€â”€ metrics.py                 # 80 lines  ğŸ†• æŒ‡æ ‡æ”¶é›† (ç®€åŒ–ç‰ˆ)
â”‚   â”‚   â””â”€â”€ notifier.py                # 40 lines  ğŸ†• é€šçŸ¥å°è£…
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                          # å·¥å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ config.py                  # 250 lines â­ ç®€åŒ– (ç§»é™¤warning validators)
â”‚   â”‚   â”œâ”€â”€ rate_limiter.py            # 50 lines  ğŸ†• Token bucketé™æµ
â”‚   â”‚   â”œâ”€â”€ price_cache.py             # 40 lines  ğŸ†• ä»·æ ¼ç¼“å­˜
â”‚   â”‚   â”œâ”€â”€ breakers.py                # 100 lines âœ… ä¿ç•™ (ç†”æ–­å™¨)
â”‚   â”‚   â””â”€â”€ logging_utils.py           # 47 lines  âœ… ä¿ç•™
â”‚   â”‚
â”‚   â”œâ”€â”€ exchanges/                      # äº¤æ˜“æ‰€å®ç°
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ interface.py               # 100 lines âœ… ä¿ç•™ (æŠ½è±¡æ¥å£)
â”‚   â”‚   â””â”€â”€ lighter/                   # ğŸ†• Vendoredä¾èµ–
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ client.py              # ~300 lines (ä»gitä¾èµ–è¿ç§»)
â”‚   â”‚       â””â”€â”€ models.py              # ~200 lines
â”‚   â”‚
â”‚   â”œâ”€â”€ pools/                          # æ± å­è®¡ç®—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ jlp.py                     # 100 lines âœ… ä¿ç•™
â”‚   â”‚   â””â”€â”€ alp.py                     # 100 lines âœ… ä¿ç•™
â”‚   â”‚
â”‚   â””â”€â”€ monitoring/                     # ç›‘æ§ (å¯é€‰)
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ prometheus_exporter.py     # 60 lines  â­ ç®€åŒ– (åªå¯¼å‡ºï¼Œä¸æ”¶é›†)
â”‚       â””â”€â”€ matsu_reporter.py          # 100 lines âœ… ä¿ç•™ (ä½œä¸ºæ’ä»¶)
â”‚
â”œâ”€â”€ tests/                              # æµ‹è¯•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                           # æ ¸å¿ƒé€»è¾‘æµ‹è¯• (100%çº¯å‡½æ•°)
â”‚   â”‚   â”œâ”€â”€ test_offset_tracker.py     # âœ… å·²æœ‰
â”‚   â”‚   â”œâ”€â”€ test_zone_calculator.py    # ğŸ†• 30 lines
â”‚   â”‚   â”œâ”€â”€ test_decision_logic.py     # ğŸ†• 150 lines (5ä¸ªå‡½æ•° Ã— 30è¡Œ)
â”‚   â”‚   â””â”€â”€ test_order_calculator.py   # ğŸ†• 30 lines
â”‚   â”‚
â”‚   â”œâ”€â”€ adapters/                       # é€‚é…å™¨æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ test_exchange_client.py    # ğŸ†• 80 lines
â”‚   â”‚   â”œâ”€â”€ test_state_store.py        # ğŸ†• 60 lines
â”‚   â”‚   â””â”€â”€ test_pool_fetcher.py       # ğŸ†• 50 lines
â”‚   â”‚
â”‚   â”œâ”€â”€ test_hedge_bot.py              # ğŸ†• é›†æˆæµ‹è¯• (100 lines)
â”‚   â”‚
â”‚   â””â”€â”€ plugins/                        # æ’ä»¶æµ‹è¯•
â”‚       â”œâ”€â”€ test_audit_log.py          # ğŸ†• 40 lines
â”‚       â””â”€â”€ test_metrics.py            # ğŸ†• 50 lines
â”‚
â”œâ”€â”€ logs/                               # æ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ audit/                          # å®¡è®¡æ—¥å¿— (append-only)
â”‚   â”‚   â”œâ”€â”€ audit_20250121.jsonl
â”‚   â”‚   â””â”€â”€ audit_20250122.jsonl
â”‚   â””â”€â”€ hedge_bot.log                  # è¿è¡Œæ—¥å¿—
â”‚
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ ARCHITECTURE.md                # åŸæœ‰æ–‡æ¡£
â”‚   â”œâ”€â”€ ARCHITECTURE_OPTIMIZATION.md   # ä¼˜åŒ–æ–¹æ¡ˆ
â”‚   â”œâ”€â”€ RADICAL_SIMPLIFICATION.md      # æ¿€è¿›é‡æ„æ–¹æ¡ˆ
â”‚   â”œâ”€â”€ REFACTORED_STRUCTURE.md        # æœ¬æ–‡æ¡£ (ç»“æ„å›¾)
â”‚   â””â”€â”€ MIGRATION_GUIDE.md             # ğŸ†• è¿ç§»æŒ‡å—
â”‚
â”œâ”€â”€ requirements.txt                    # â­ ç®€åŒ– (æ— gitä¾èµ–)
â”œâ”€â”€ Dockerfile                          # âœ… ä¿ç•™
â”œâ”€â”€ docker-compose.yml                 # âœ… ä¿ç•™
â”œâ”€â”€ .env.example                        # âœ… ä¿ç•™
â””â”€â”€ README.md                           # â­ æ›´æ–°

æ€»è®¡: 780 lines (æ ¸å¿ƒ) + 500 lines (vendor) = 1,280 lines
åˆ é™¤: pipeline.py (1064), HedgeEngine (250), DecisionEngine (443), ActionExecutor (429)
       = 2,186 lines
å‡€å‡å°‘: 906 lines (-41% ä¸å«vendor)
```

---

## ğŸ—ï¸ æ¶æ„å±‚æ¬¡å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          main.py                                 â”‚
â”‚                    (å…¥å£ + æ’ä»¶ç»„è£…)                            â”‚
â”‚                                                                  â”‚
â”‚  bot = HedgeBot(config, exchange, pools)                        â”‚
â”‚  bot.on_order_placed.append(audit.log_order)                    â”‚
â”‚  bot.on_order_placed.append(metrics.record_order)               â”‚
â”‚  await bot.run_cycle()                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Layer 3: ç¼–æ’å±‚                              â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚             hedge_bot.py (200 lines)                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  async def run_cycle():                             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    1. è·å–æ•°æ® (å¹¶å‘)                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    2. è®¡ç®—åç§» (è°ƒç”¨çº¯å‡½æ•°)                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    3. å†³ç­– (è°ƒç”¨çº¯å‡½æ•°)                            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    4. æ‰§è¡Œ (è°ƒç”¨é€‚é…å™¨)                            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    5. è§¦å‘å›è°ƒ (å¯é€‰æ’ä»¶)                          â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â–²                              â–²
                â”‚                              â”‚
       è°ƒç”¨çº¯å‡½æ•°                          è°ƒç”¨é€‚é…å™¨
                â”‚                              â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â–¼                      â–¼      â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Layer 1:     â”‚  â”‚  Layer 2: I/O é€‚é…å™¨å±‚   â”‚  â”‚  Plugins:    â”‚
â”‚  çº¯å‡½æ•°å±‚    â”‚  â”‚                          â”‚  â”‚  å¯é€‰åŠŸèƒ½    â”‚
â”‚              â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚ exchange_client.py â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚offset_   â”‚ â”‚  â”‚  â”‚   - place_order()  â”‚  â”‚  â”‚ â”‚audit_log â”‚ â”‚
â”‚ â”‚tracker   â”‚ â”‚  â”‚  â”‚   - get_price()    â”‚  â”‚  â”‚ â”‚          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚   - confirm()      â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚              â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚                          â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚zone_     â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚metrics   â”‚ â”‚
â”‚ â”‚calculatorâ”‚ â”‚  â”‚  â”‚ state_store.py     â”‚  â”‚  â”‚ â”‚          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚   - get(key)       â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚              â”‚  â”‚  â”‚   - set(key, val)  â”‚  â”‚  â”‚              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚decision_ â”‚ â”‚  â”‚                          â”‚  â”‚ â”‚notifier  â”‚ â”‚
â”‚ â”‚logic     â”‚ â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚          â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â”‚ pool_fetcher.py    â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚              â”‚  â”‚  â”‚   - fetch_jlp()    â”‚  â”‚  â”‚              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”‚   - fetch_alp()    â”‚  â”‚  â”‚              â”‚
â”‚ â”‚order_    â”‚ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚              â”‚
â”‚ â”‚calculatorâ”‚ â”‚  â”‚                          â”‚  â”‚              â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚              â”‚
â”‚  ç‰¹ç‚¹:       â”‚         ç‰¹ç‚¹:                      ç‰¹ç‚¹:
â”‚  â€¢ é›¶ä¾èµ–   â”‚         â€¢ è–„å°è£…                   â€¢ å›è°ƒæ³¨å…¥
â”‚  â€¢ çº¯å‡½æ•°   â”‚         â€¢ é”™è¯¯å¤„ç†                 â€¢ å¯é€‰å¯ç”¨
â”‚  â€¢ 100%æµ‹è¯• â”‚         â€¢ ç†”æ–­ä¿æŠ¤                 â€¢ éä¾µå…¥å¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ æ•°æ®æµå›¾

```
                    å¯åŠ¨
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   main.py      â”‚
            â”‚  åŠ è½½é…ç½®      â”‚
            â”‚  åˆå§‹åŒ–ç»„ä»¶    â”‚
            â”‚  æ³¨å†Œæ’ä»¶      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  HedgeBot.run_cycle()  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚            â”‚
        â–¼            â–¼            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”
    â”‚ JLP  â”‚   â”‚   ALP    â”‚  â”‚ ... â”‚
    â”‚æ± æ•°æ®â”‚   â”‚  æ± æ•°æ®  â”‚  â”‚     â”‚  1. å¹¶å‘è·å–æ± å­æ•°æ®
    â””â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”˜
       â”‚            â”‚           â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ calculate_ideal()    â”‚  2. è®¡ç®—ç†æƒ³å¯¹å†²é‡
         â”‚  (çº¯å‡½æ•°åˆå¹¶)        â”‚     (çº¯å‡½æ•°)
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           â”‚           â”‚
        â–¼           â–¼           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”
    â”‚ä»·æ ¼  â”‚  â”‚ å®é™…æŒä»“ â”‚ â”‚ ... â”‚  3. å¹¶å‘è·å–å¸‚åœºæ•°æ®
    â””â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜     (å¸¦ç¼“å­˜ + é™æµ)
       â”‚           â”‚          â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ FOR EACH symbol:           â”‚
      â”‚                            â”‚
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
      â”‚  â”‚ offset_tracker()     â”‚  â”‚  4. è®¡ç®—åç§» + æˆæœ¬
      â”‚  â”‚  (çº¯å‡½æ•°)            â”‚  â”‚     (çº¯å‡½æ•°)
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
      â”‚             â”‚               â”‚
      â”‚             â–¼               â”‚
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
      â”‚  â”‚ zone_calculator()    â”‚  â”‚  5. è®¡ç®—Zone
      â”‚  â”‚  (çº¯å‡½æ•°)            â”‚  â”‚     (çº¯å‡½æ•°)
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
      â”‚             â”‚               â”‚
      â”‚             â–¼               â”‚
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
      â”‚  â”‚ decision_logic()     â”‚  â”‚  6. å†³ç­–
      â”‚  â”‚  - è¶…è¿‡é˜ˆå€¼?        â”‚  â”‚     (çº¯å‡½æ•°)
      â”‚  â”‚  - è¶…æ—¶?            â”‚  â”‚
      â”‚  â”‚  - Zoneå˜åŒ–?        â”‚  â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
      â”‚             â”‚               â”‚
      â”‚             â–¼               â”‚
      â”‚        Decision            â”‚
      â”‚    (action, side, size)    â”‚
      â”‚             â”‚               â”‚
      â”‚             â–¼               â”‚
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
      â”‚  â”‚ exchange_client      â”‚  â”‚  7. æ‰§è¡Œ
      â”‚  â”‚  .place_order()      â”‚  â”‚     (I/Oé€‚é…å™¨)
      â”‚  â”‚  .confirm()          â”‚  â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
      â”‚             â”‚               â”‚
      â”‚             â–¼               â”‚
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
      â”‚  â”‚ state_store          â”‚  â”‚  8. æ›´æ–°çŠ¶æ€
      â”‚  â”‚  .update(symbol, {}) â”‚  â”‚     (I/Oé€‚é…å™¨)
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
      â”‚             â”‚               â”‚
      â”‚             â–¼               â”‚
      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
      â”‚  â”‚ è§¦å‘å›è°ƒ:            â”‚  â”‚  9. å¯é€‰æ’ä»¶
      â”‚  â”‚  â€¢ audit.log()       â”‚  â”‚     (å›è°ƒ)
      â”‚  â”‚  â€¢ metrics.record()  â”‚  â”‚
      â”‚  â”‚  â€¢ notifier.alert()  â”‚  â”‚
      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
      â”‚                            â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ è¿”å›ç»“æœ        â”‚
         â”‚ sleep(interval) â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š ä¾èµ–å…³ç³»å›¾

```
main.py
  â”‚
  â”œâ”€> HedgeBot
  â”‚     â”‚
  â”‚     â”œâ”€> config (dict)
  â”‚     â”œâ”€> ExchangeClient
  â”‚     â”‚     â””â”€> lighter (vendored)
  â”‚     â””â”€> PoolFetcher
  â”‚           â”œâ”€> jlp.calculate_hedge
  â”‚           â””â”€> alp.calculate_hedge
  â”‚
  â”œâ”€> Plugins (å¯é€‰)
  â”‚     â”œâ”€> AuditLog
  â”‚     â”œâ”€> Metrics
  â”‚     â””â”€> Notifier
  â”‚
  â””â”€> Pure Functions (é›¶ä¾èµ–!)
        â”œâ”€> offset_tracker()
        â”œâ”€> zone_calculator()
        â”œâ”€> decision_logic()
        â””â”€> order_calculator()


å¯¹æ¯”ï¼šæ—§æ¶æ„çš„ä¾èµ–åœ°ç‹±

HedgeEngine
  â”œâ”€> StateManager
  â”œâ”€> CircuitBreakerManager
  â”œâ”€> MetricsCollector
  â”œâ”€> Exchange
  â”œâ”€> Notifier
  â”œâ”€> MatsuReporter
  â”œâ”€> DecisionEngine
  â”‚     â””â”€> StateManager (é‡å¤ä¾èµ–!)
  â”œâ”€> ActionExecutor
  â”‚     â”œâ”€> Exchange (é‡å¤ä¾èµ–!)
  â”‚     â”œâ”€> StateManager (é‡å¤ä¾èµ–!)
  â”‚     â”œâ”€> Notifier (é‡å¤ä¾èµ–!)
  â”‚     â”œâ”€> MetricsCollector (é‡å¤ä¾èµ–!)
  â”‚     â””â”€> CircuitBreakerManager (é‡å¤ä¾èµ–!)
  â””â”€> Pipeline
        â””â”€> 10ä¸ªStepç±»
              â””â”€> æ¯ä¸ªéƒ½éœ€è¦å¤šä¸ªä¾èµ–...
```

---

## ğŸ” æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 1. `core/` - çº¯å‡½æ•°å±‚

```python
# offset_tracker.py (92 lines) - å·²å®Œç¾
def calculate_offset_and_cost(
    ideal_position: float,
    actual_position: float,
    current_price: float,
    old_offset: float,
    old_cost: float
) -> tuple[float, float]

# zone_calculator.py (30 lines) - æ–°å¢
def calculate_zone(
    offset_usd: float,
    threshold_min: float,
    threshold_max: float,
    threshold_step: float
) -> int | None

# decision_logic.py (100 lines) - æ–°å¢
def decide_on_threshold_breach(...) -> Decision
def decide_on_timeout(...) -> Decision
def decide_on_zone_change(...) -> Decision
def _decide_in_cooldown(...) -> Decision
def _create_limit_order(...) -> Decision

# order_calculator.py (30 lines) - æ–°å¢
def calculate_order_price(cost_basis: float, offset: float, pct: float) -> float
def calculate_order_size(offset: float, close_ratio: float) -> float
```

**ç‰¹ç‚¹ï¼š**
- âœ… é›¶å¤–éƒ¨ä¾èµ–
- âœ… çº¯å‡½æ•°ï¼ˆæ— å‰¯ä½œç”¨ï¼‰
- âœ… æ˜“äºæµ‹è¯•ï¼ˆä¸éœ€è¦mockï¼‰
- âœ… æ˜“äºç†è§£ï¼ˆæ¯ä¸ªå‡½æ•° < 30è¡Œï¼‰

---

### 2. `adapters/` - I/Oé€‚é…å™¨å±‚

```python
# exchange_client.py (100 lines)
class ExchangeClient:
    """è–„å°è£… + è®¢å•ç¡®è®¤"""

    def __init__(self, exchange_impl, rate_limiter=None, circuit_breaker=None):
        self.exchange = exchange_impl
        self.limiter = rate_limiter
        self.breaker = circuit_breaker

    async def place_order(...) -> str:
        # 1. é™æµ
        async with self.limiter:
            # 2. ç†”æ–­ä¿æŠ¤
            order_id = await self.breaker.call(
                self.exchange.place_limit_order, ...
            )

            # 3. Double-checkç¡®è®¤
            await asyncio.sleep(0.1)
            status = await self.exchange.get_order_status(order_id)
            if status not in ["open", "filled"]:
                raise Exception(...)

            return order_id

# state_store.py (80 lines)
class StateStore:
    """ç®€å•çš„å¼‚æ­¥dictå°è£…"""

    async def get(self, key: str, default=None)
    async def set(self, key: str, value)
    async def update(self, key: str, partial: dict)

# pool_fetcher.py (60 lines)
class PoolFetcher:
    """æ± å­æ•°æ®è·å– + åˆå¹¶"""

    async def fetch_all(self) -> dict
    async def fetch_jlp(self, amount: float) -> dict
    async def fetch_alp(self, amount: float) -> dict
```

**ç‰¹ç‚¹ï¼š**
- âœ… è–„å°è£…ï¼ˆä¸åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼‰
- âœ… é”™è¯¯å¤„ç†
- âœ… é™æµ + ç†”æ–­ + ç¡®è®¤
- âœ… æ˜“äºæ›¿æ¢å®ç°

---

### 3. `hedge_bot.py` - ç¼–æ’å±‚

```python
class HedgeBot:
    """
    å¯¹å†²æœºå™¨äºº - ç¼–æ’é€»è¾‘

    èŒè´£ï¼š
    - è°ƒç”¨çº¯å‡½æ•°
    - è°ƒç”¨é€‚é…å™¨
    - è§¦å‘å›è°ƒ

    ä¸åŒ…å«ï¼š
    - ä¸šåŠ¡è§„åˆ™ (åœ¨çº¯å‡½æ•°å±‚)
    - I/Oç»†èŠ‚ (åœ¨é€‚é…å™¨å±‚)
    """

    def __init__(self, config, exchange, pool_fetchers):
        self.config = config
        self.exchange = ExchangeClient(exchange)
        self.state = StateStore()
        self.pools = PoolFetcher(pool_fetchers)

        # å›è°ƒåˆ—è¡¨ (å¯é€‰æ’ä»¶)
        self.on_order_placed = []
        self.on_position_changed = []
        self.on_error = []

    async def run_cycle(self):
        # 1. è·å–æ•°æ®
        pool_data = await self.pools.fetch_all()
        ideal = self._calculate_ideal(pool_data)

        prices, positions = await asyncio.gather(
            self._fetch_prices(ideal.keys()),
            self._fetch_positions(ideal.keys())
        )

        # 2. å¤„ç†æ¯ä¸ªsymbol
        for symbol in ideal.keys():
            # è·å–çŠ¶æ€
            state = await self.state.get(symbol, {})

            # è°ƒç”¨çº¯å‡½æ•°è®¡ç®—
            offset, cost = calculate_offset_and_cost(...)
            zone = calculate_zone(...)
            decision = self._make_decision(...)

            # æ‰§è¡Œ
            if decision.action == "place_order":
                order_id = await self.exchange.place_order(...)

                # è§¦å‘å›è°ƒ
                for callback in self.on_order_placed:
                    await callback(symbol, order_id, ...)

            # æ›´æ–°çŠ¶æ€
            await self.state.update(symbol, {...})
```

**ç‰¹ç‚¹ï¼š**
- âœ… åªåšç¼–æ’ï¼Œæ— ä¸šåŠ¡é€»è¾‘
- âœ… 200è¡Œå®Œæˆæ‰€æœ‰æµç¨‹
- âœ… æ¸…æ™°çš„æ§åˆ¶æµ
- âœ… æ˜“äºæµ‹è¯•ï¼ˆmocké€‚é…å™¨å³å¯ï¼‰

---

### 4. `plugins/` - å¯é€‰åŠŸèƒ½

```python
# audit_log.py (60 lines)
class AuditLog:
    async def log_order(self, symbol, order_id, side, size, price):
        """å›è°ƒå‡½æ•° - è®°å½•è®¢å•"""
        with open(self.log_file, 'a') as f:
            f.write(json.dumps({
                "timestamp": datetime.now().isoformat(),
                "event": "order_placed",
                "symbol": symbol,
                "order_id": order_id,
                "side": side,
                "size": size,
                "price": price
            }) + '\n')
            f.flush()
            os.fsync(f.fileno())

# metrics.py (80 lines)
class MetricsCollector:
    async def record_order(self, symbol, order_id, side, size, price):
        """å›è°ƒå‡½æ•° - è®°å½•æŒ‡æ ‡"""
        self.orders_total.labels(symbol=symbol, side=side).inc()
        self.order_size.labels(symbol=symbol).observe(size)

# notifier.py (40 lines)
class Notifier:
    async def notify_order(self, symbol, order_id, side, size, price):
        """å›è°ƒå‡½æ•° - å‘é€é€šçŸ¥"""
        await self.apprise.notify(
            f"Order placed: {symbol} {side} {size} @ {price}"
        )
```

**ä½¿ç”¨æ–¹å¼ï¼š**
```python
# main.py
bot = HedgeBot(...)

# å¯é€‰ï¼šå¯ç”¨å®¡è®¡æ—¥å¿—
audit = AuditLog("logs/audit")
bot.on_order_placed.append(audit.log_order)

# å¯é€‰ï¼šå¯ç”¨æŒ‡æ ‡
metrics = MetricsCollector()
bot.on_order_placed.append(metrics.record_order)

# å¯é€‰ï¼šå¯ç”¨é€šçŸ¥
notifier = Notifier(config["pushover"])
bot.on_order_placed.append(notifier.notify_order)

# ä¸æƒ³è¦ï¼Ÿä¸æ³¨å†Œå³å¯ï¼
```

**ç‰¹ç‚¹ï¼š**
- âœ… å®Œå…¨å¯é€‰
- âœ… éä¾µå…¥å¼
- âœ… æ˜“äºæ·»åŠ æ–°æ’ä»¶
- âœ… ç¬¦åˆå¼€é—­åŸåˆ™

---

## ğŸ“ ä»£ç è¡Œæ•°å¯¹æ¯”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ ¸å¿ƒé€»è¾‘å¯¹æ¯”                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ¨¡å—              â”‚  æ—§      â”‚  æ–°    â”‚  å˜åŒ–          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Pipeline          â”‚  1,064   â”‚  0     â”‚  -1,064 åˆ é™¤   â”‚
â”‚  HedgeEngine       â”‚  250     â”‚  0     â”‚  -250 åˆ é™¤     â”‚
â”‚  DecisionEngine    â”‚  443     â”‚  0     â”‚  -443 åˆ é™¤     â”‚
â”‚  ActionExecutor    â”‚  429     â”‚  0     â”‚  -429 åˆ é™¤     â”‚
â”‚                    â”‚          â”‚        â”‚                â”‚
â”‚  hedge_bot         â”‚  0       â”‚  200   â”‚  +200 æ–°å¢     â”‚
â”‚  decision_logic    â”‚  0       â”‚  100   â”‚  +100 æ–°å¢     â”‚
â”‚  zone_calculator   â”‚  0       â”‚  30    â”‚  +30 æ–°å¢      â”‚
â”‚  order_calculator  â”‚  0       â”‚  30    â”‚  +30 æ–°å¢      â”‚
â”‚  offset_tracker    â”‚  92      â”‚  92    â”‚  0 ä¿æŒ        â”‚
â”‚                    â”‚          â”‚        â”‚                â”‚
â”‚  exchange_client   â”‚  0       â”‚  100   â”‚  +100 æ–°å¢     â”‚
â”‚  state_store       â”‚  150     â”‚  80    â”‚  -70 ç®€åŒ–      â”‚
â”‚  pool_fetcher      â”‚  0       â”‚  60    â”‚  +60 æ–°å¢      â”‚
â”‚                    â”‚          â”‚        â”‚                â”‚
â”‚  audit_log         â”‚  0       â”‚  60    â”‚  +60 æ–°å¢      â”‚
â”‚  metrics           â”‚  100     â”‚  80    â”‚  -20 ç®€åŒ–      â”‚
â”‚  notifier          â”‚  80      â”‚  40    â”‚  -40 ç®€åŒ–      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ€»è®¡              â”‚  2,608   â”‚  872   â”‚  -1,736 (-67%) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å®Œæ•´é¡¹ç›®å¯¹æ¯”                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç±»åˆ«              â”‚  æ—§      â”‚  æ–°    â”‚  è¯´æ˜          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ ¸å¿ƒé€»è¾‘          â”‚  2,608   â”‚  872   â”‚  å¦‚ä¸Šè¡¨        â”‚
â”‚  é…ç½®ç®¡ç†          â”‚  470     â”‚  250   â”‚  -220 ç®€åŒ–     â”‚
â”‚  å·¥å…·æ¨¡å—          â”‚  227     â”‚  137   â”‚  -90 ç®€åŒ–      â”‚
â”‚  äº¤æ˜“æ‰€            â”‚  250     â”‚  500   â”‚  +250 vendor   â”‚
â”‚  æ± å­              â”‚  200     â”‚  200   â”‚  0 ä¿æŒ        â”‚
â”‚  ç›‘æ§              â”‚  250     â”‚  160   â”‚  -90 ç®€åŒ–      â”‚
â”‚  é€šçŸ¥              â”‚  153     â”‚  40    â”‚  -113 ç®€åŒ–     â”‚
â”‚  æµ‹è¯•              â”‚  350     â”‚  590   â”‚  +240 å¢å¼º     â”‚
â”‚  æ–‡æ¡£              â”‚  664     â”‚  950   â”‚  +286 å¢åŠ      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ€»è®¡ (å«vendor)   â”‚  5,172   â”‚  3,699 â”‚  -1,473 (-28%) â”‚
â”‚  æ€»è®¡ (ä¸å«vendor) â”‚  4,922   â”‚  3,199 â”‚  -1,723 (-35%) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ å…³é”®æ”¹è¿›ç‚¹

### 1. å¤æ‚åº¦é™ä½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æŒ‡æ ‡           â”‚  æ—§    â”‚  æ–°   â”‚ æ”¹è¿› â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœ€é•¿å‡½æ•°       â”‚  230è¡Œ â”‚  30è¡Œ â”‚ -87% â”‚
â”‚  å¹³å‡å‡½æ•°é•¿åº¦   â”‚  45è¡Œ  â”‚  18è¡Œ â”‚ -60% â”‚
â”‚  æœ€å¤§åµŒå¥—æ·±åº¦   â”‚  5å±‚   â”‚  2å±‚  â”‚ -60% â”‚
â”‚  å¾ªç¯å¤æ‚åº¦     â”‚  15+   â”‚  5    â”‚ -67% â”‚
â”‚  ç±»çš„æ•°é‡       â”‚  15ä¸ª  â”‚  3ä¸ª  â”‚ -80% â”‚
â”‚  å¹³å‡ä¾èµ–æ•°     â”‚  4.2   â”‚  1.5  â”‚ -64% â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. å¯æµ‹è¯•æ€§æå‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æŒ‡æ ‡               â”‚  æ—§     â”‚  æ–°    â”‚     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚  çº¯å‡½æ•°å æ¯”         â”‚  10%    â”‚  70%   â”‚ +7x â”‚
â”‚  éœ€è¦mockçš„ä¾èµ–     â”‚  å¹³å‡5  â”‚  å¹³å‡0 â”‚ -5  â”‚
â”‚  å•å…ƒæµ‹è¯•è¡Œæ•°       â”‚  350    â”‚  590   â”‚ +69%â”‚
â”‚  æµ‹è¯•è¦†ç›–ç‡         â”‚  60%    â”‚  95%   â”‚ +58%â”‚
â”‚  é›†æˆæµ‹è¯•å¤æ‚åº¦     â”‚  é«˜     â”‚  ä½    â”‚  âœ… â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. å¯ç»´æŠ¤æ€§

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æŒ‡æ ‡                   â”‚  æ—§      â”‚  æ–°      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ–°äººç†è§£æ—¶é—´           â”‚  2å°æ—¶   â”‚  30åˆ†é’Ÿ  â”‚
â”‚  æ·»åŠ æ–°åŠŸèƒ½å¹³å‡æ—¶é—´     â”‚  2å¤©     â”‚  åŠå¤©    â”‚
â”‚  ä¿®å¤bugå¹³å‡æ—¶é—´        â”‚  1å¤©     â”‚  2å°æ—¶   â”‚
â”‚  ä»£ç å®¡æŸ¥æ—¶é—´           â”‚  1å°æ—¶   â”‚  20åˆ†é’Ÿ  â”‚
â”‚  é‡æ„é£é™©               â”‚  é«˜      â”‚  ä½      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ è¿ç§»è·¯å¾„

```
Week 1: åˆ›å»ºçº¯å‡½æ•°å±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… zone_calculator.py          â”‚
â”‚ âœ… decision_logic.py            â”‚
â”‚ âœ… order_calculator.py          â”‚
â”‚ âœ… 100% æµ‹è¯•è¦†ç›–               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Week 2: åˆ›å»ºé€‚é…å™¨å±‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… exchange_client.py           â”‚
â”‚ âœ… state_store.py               â”‚
â”‚ âœ… pool_fetcher.py              â”‚
â”‚ âœ… å•å…ƒæµ‹è¯•                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Week 3: åˆ›å»ºç¼–æ’å±‚ + æ’ä»¶
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… hedge_bot.py                 â”‚
â”‚ âœ… plugins/audit_log.py         â”‚
â”‚ âœ… plugins/metrics.py           â”‚
â”‚ âœ… plugins/notifier.py          â”‚
â”‚ âœ… é›†æˆæµ‹è¯•                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Week 4: å¹¶è¡Œè¿è¡Œ + åˆ‡æ¢
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… æ–°æ—§ç³»ç»ŸåŒæ—¶è¿è¡Œ            â”‚
â”‚ âœ… å¯¹æ¯”è¾“å‡ºç»“æœ                â”‚
â”‚ âœ… æ€§èƒ½æµ‹è¯•                    â”‚
â”‚ âœ… ç¡®è®¤æ— è¯¯ååˆ‡æ¢              â”‚
â”‚ âœ… åˆ é™¤æ—§ä»£ç                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ€»ç»“

### æ—§æ¶æ„çš„é—®é¢˜
```
âŒ è¿‡åº¦æŠ½è±¡ (15ä¸ªç±», 8ä¸ªManager)
âŒ ä¾èµ–åœ°ç‹± (ActionExecutoréœ€è¦5ä¸ªä¾èµ–)
âŒ å·¨å‹å‡½æ•° (decide()æ–¹æ³•230è¡Œ)
âŒ ç¡¬ç¼–ç æ’ä»¶ (metrics/notifierå¼ºåˆ¶ä¾èµ–)
âŒ éš¾ä»¥æµ‹è¯• (éœ€è¦mockå¤§é‡å¯¹è±¡)
```

### æ–°æ¶æ„çš„ä¼˜åŠ¿
```
âœ… 3å±‚æ¶æ„ (æ¸…æ™°åˆ†å±‚)
âœ… çº¯å‡½æ•° (70%ä»£ç é›¶ä¾èµ–)
âœ… å›è°ƒæ³¨å…¥ (æ’ä»¶å¯é€‰)
âœ… æ˜“äºæµ‹è¯• (å¹³å‡0ä¸ªmock)
âœ… ä»£ç å‡å°‘67% (æ ¸å¿ƒé€»è¾‘)
```

### Linusçš„è¯„ä»·
> "Finally, code that doesn't make me want to throw my computer out the window. Simple, direct, testable. THIS is how you write software."

---

**è¿™å°±æ˜¯é‡æ„åçš„å®Œæ•´ç»“æ„ï¼** ğŸ‰
